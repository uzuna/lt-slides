## Riotjsに乗り換え中の話
2015/12/05 LTDD#21

---

### 自己紹介

|||
|:---|:---|
|名前|uzuna|
|仕事|製造系:製品解析|
|趣味|読書|
|twitter|@Uzundk|
|読書メーター|同上|
|よく使う|nodejs(ES6)|

---

11月のお勧め図書

<img class="img" src="image/201512_book.jpg" width="120px">

* フォークの歯はなぜ四本になったか
* 発刊 1995年11月
* 著者 ヘンリーペトロスキー

--

実用品の進化論

--

人工物の形は誰かの思いついた  
"完璧な形"になっているのだろうか

--

初期のフォークとは"木の枝"

丸焼きの肉とそれを切り分けるナイフ  
その肉を固定するための付属品が始まり

--

ある時期からナイフ二本で食べるのがCoolとされる  
先の尖ったナイフで刺して止めて、もう一つのナイフで切る

この頃のナイフとは料理用ではなく武器としてのナイフ  
->テーブルマナー = 害意がないことを示す

--

ナイフを刺すと一点固定->軸回転  
2点で刺せば良いのでは? -> 二本のフォークが出来る

--

2本だと細かいものがつかめない  
->本数を増やそう = 4本

--

口の大きさ、刺しやすさと落ちにくさ、  
食事をする上での不具合の度に変更をする

--

不具合に対して改善をしていく
「形は失敗に従う」

--

---

というわけで本題

---

__Riotjsに乗り換え中の話__

---

みなさんHTML書いてますか?

--

皆さんHTML書かざるをえないですか?

--

感謝、そう私は感謝しているのです。  
HTMLのおかげでリッチな視覚情報を得ることができることに...

--

ですが...ですが...

--

<img class="img" src="image/google.png">

--

__書くのはすごくめんどくさい!__

そこで

---

## Riotjs (+jade)
A React-like user interface micro-library

--

Riotjsの特徴

* カスタムタグの機能を提供
* 独自拡張が少ない
* 軽量(26KB)


--

何がうれしいのか

1. html表記 -> JadeTemplate
2. DOM操作 -> ShadowDOM
3. ファイル管理 -> 1コンポーネント=1File

---

### 導入の理由

1. 同じ情報をいくつもの見方をする
	* サーバーサイドで別々レンダリングは手間
	* データはクライアント側で操作できるほうが好ましい
	* レンダリング処理が重い
2. jQueryを使いたくない
	* DOMとデータの両方を気にするとか複雑すぎる...

--

導入した結果どうなったか

--

### HTML生成
Jade -> .html + Ajax

サーバーサイドは静的ファイルとJSONのみ!

--

### script
/js/*.js -> /bundle.js

レンダリングや処理はコンポーネントの中に!

---

> カスタムタグは、関連するHTMLとJavaScriptをくっつけて再利用可能なコンポーネントとしてまとめます。React + Polymerに、"楽しい"文法と小さな学習曲線が一緒になった、とイメージしてください。

--

```jade
//tabpage.tag
tabpage
	h3 Tab Page
	div.context
		div(class="ui menu")
			a(class='item', each="{tab, i in tabs}", data-tab="{tab}") {tab}
	script.
		// thisで定義したものがコンポーネント内で使える
		this.tabs = ["first", "second", "third"]
```

--

```jade
//index.jade
doctype html
html
	head
		link(rel="stylesheet", type='text/css', href='semantic/dist/semantic.min.css')
		script(src='js/superagent.js')
	body
		div(class='ui container')
			tabpage // タグを入れるだけ
		script(src='js/riot+compiler.min.js')  // riotjs本体
		script(src='tabpage.tag', type="riot/tag")  // 読み込み
		script.
			riot.mount('*');
```
---

### なぜRiotjsだったのか?

* そもそも必要なのは最低限の機能
	* ごついサイトは作らない
* javascriptの中に書くHTMLが好みでない
	* ベタHTMLをjs内に書くって本末転倒な気がする
* 学習コストをかけたくない

--

他便利なところ

* Jadeが標準で使える
* gulp-concatでコンパイル可能

--

今後試すこと

* UIデザインのカスタムコンポーネント化
* router
* observer

--

* 参考:[React.jsではなくRiot.jsを採用した話、運用中サービス『GAMY』でリニューアル](http://qiita.com/narikei/items/1a7fbd7895cfb4220172)

